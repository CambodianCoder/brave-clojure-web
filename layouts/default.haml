!!!
- @items = chapters
- count = @items.size
- index = @items.index(@item)
%html{:lang => "en"}
  %head
    %meta{:charset => "utf-8"}/
    %meta{:path => @item.path}
    %base{:href => "/"}/
    %title
      #{@item[:title]}
      - if @item[:title] != 'Clojure for the Brave and True, a Practical Guide for Stouthearted Beginners'
        | Clojure for the Brave and True
    %link{:href => relative_path_to("/stylesheets/main.css"), :media => "screen", :rel => "stylesheet", :type => "text/css"}/
    %link{:href => relative_path_to("/stylesheets/pygments.css"), :media => "screen", :rel => "stylesheet", :type => "text/css"}/
    %link{:href => 'http://fonts.googleapis.com/css?family=Oswald:400,300|Gentium+Book+Basic:400,700|Fjalla+One|Courgette', :rel => 'stylesheet', :type => 'text/css'}
  %body
    .masthead
      .container
        .title
          CLOJURE
          %span> for the
          BRAVE
          %span> and
          TRUE
        .subtitle
          %span a practical book for stouthearted beginners
      .lambda
        Î»
    .engage-me-please
      .container
        %a.buy{:href => "https://leanpub.com/clojure-for-the-brave-and-true"} Buy the DRM-free PDF, epub, and mobi!
        %form#mc-embedded-subscribe-form.validate{:action => "http://flyingmachinestudios.us1.list-manage.com/subscribe/post?u=60763b0c4890c24bd055f32e6&amp;amp;id=0b40ffd1e1", :method => "post", :name => "mc-embedded-subscribe-form", :novalidate => "", :target => "_blank"}
          %p
            Spending your nights pining for the next chapter of
            <em>Clojure for the Brave and True</em>?
            %br/
            Then follow
            %a{:href => "https://twitter.com/nonrecursive"} @nonrecursive
            or subscribe for email updates:
            %input#mce-EMAIL.email{:name => "EMAIL", :placeholder => "email address", :required => "", :type => "email", :value => ""}/
            %input#mc-embedded-subscribe.button{:name => "subscribe", :type => "submit", :value => "Subscribe!"}/
    #top-nav
      .items.container
        %ul
          %li.home
            - if index
              - if index != 0
                - i = @items[index - 1]
                
                %a{:href => relative_path_to(i)}
                  &larr;
              %a{:href => "/"} &uarr;
              - if i = @items[index + 1]
                %a{:href => relative_path_to(i)}
                  &rarr;
          %li.chapters
            %select
              - chapters.each do |i|
                %option{:selected => (i == @item ? "selected" : nil)}
                  Chapter X
          %li
            %a.buy{:href => "https://leanpub.com/clojure-for-the-brave-and-true"} buy the  ebook!!?!
          %li.subscribe
            %form#mc-embedded-subscribe-form.validate{:action => "http://flyingmachinestudios.us1.list-manage.com/subscribe/post?u=60763b0c4890c24bd055f32e6&amp;amp;id=0b40ffd1e1", :method => "post", :name => "mc-embedded-subscribe-form", :novalidate => "", :target => "_blank"}
              %input#mce-EMAIL.email{:name => "EMAIL", :placeholder => "email address", :required => "", :type => "email", :value => ""}/
              %input#mc-embedded-subscribe.button{:name => "subscribe", :type => "submit", :value => "subscribe"}/
          %li.tweet
            %a.twitter-share-button{:href => "https://twitter.com/share"} tweet bravely and truly
            :javascript
              !function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs')
        
    .page.container
      .chapter-nav
        .wrapper
          %form#search{:action => "/search/"}
            %input#tipue_search_input{:name => "q", :type => "search", :placeholder => "Search"}
          %ol
            %li
              %a{:href => "/organization/#1__Your_Project_as_a_Library"} 1. Your Project as a Library
            %li
              %a{:href => "/organization/#2__Storing_Objects_with_def"} 2. Storing Objects with def
            %li
              %a{:href => "/organization/#3__Creating_and_Switching_to_Namespaces"} 3. Creating and Switching to Namespaces
            %li
              %a{:href => "/organization/#4__refer_and_alias"} 4. refer and alias
            %li
              %a{:href => "/organization/#5__Real_Project_Organization"} 5. Real Project Organization
              %ol
                %li
                  %a{:href => "/organization/#5_1__The_relationship_between_file_paths_and_namespace_names"} 5.1. The relationship between file paths and namespace names
                %li
                  %a{:href => "/organization/#5_2__Loading_a_file_with_require_and_use"} 5.2. Loading a file with require and use
                %li
                  %a{:href => "/organization/#5_3__Using_ns"} 5.3. Using ns
            %li
              %a{:href => "/organization/#6__To_Catch_a_Burglar"} 6. To Catch a Burglar
            %li
              %a{:href => "/organization/#7__Summary"} 7. Summary

      .content
        = find_and_preserve(yield)
        .pagenav.bottom
          - if index
            - if index != 0
              - i = @items[index - 1]
              .prev
                %a{:href => relative_path_to(i)}
                  &larr;
                  = i[:link_title]
            - if i = @items[index + 1]
              .next
                %a{:href => relative_path_to(i)}
                  = i[:link_title]
                  &rarr;
          
        #disqus_thread
        :javascript
          /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
          var disqus_shortname = 'clojureforthebraveandtrue'; // required: replace example with your forum shortname

          /* * * DON'T EDIT BELOW THIS LINE * * */
          (function() {
              var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
              dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
              (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
          })();

    %script{:src => "https://code.jquery.com/jquery-2.1.1.min.js"}
    %script{:src => relative_path_to("/javascripts/jquery.sticky.js")}
    %script{:src => relative_path_to("/javascripts/sticky.js")}
    :javascript
      var _gaq = _gaq || [];
      _gaq.push(['_setAccount', 'UA-43463851-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();

